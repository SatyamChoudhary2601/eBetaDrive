{"ast":null,"code":"var _jsxFileName = \"D:\\\\e beta react native\\\\eBetaDrive\\\\web-app\\\\src\\\\views\\\\AddBookings.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useContext } from 'react';\nimport { Select, MenuItem, Grid, Button, Dialog, DialogActions, DialogContent, DialogContentText, DialogTitle, Typography, TextField } from '@material-ui/core';\nimport GoogleMapsAutoComplete from '../components/GoogleMapsAutoComplete';\nimport { useSelector, useDispatch } from \"react-redux\";\nimport AlertDialog from '../components/AlertDialog';\nimport { language } from 'config';\nimport { makeStyles } from '@material-ui/core/styles';\nimport UsersCombo from '../components/UsersCombo';\nimport { FirebaseContext } from 'common';\nimport { features } from 'config';\nconst useStyles = makeStyles(theme => ({\n  root: {\n    '& > *': {\n      margin: theme.spacing(1)\n    }\n  },\n  '@global': {\n    body: {\n      backgroundColor: theme.palette.common.white\n    }\n  },\n  container: {\n    zIndex: \"12\",\n    color: \"#FFFFFF\",\n    alignContent: 'center'\n  },\n  title: {\n    color: \"#000\"\n  },\n  gridcontainer: {\n    alignContent: 'center'\n  },\n  items: {\n    margin: 0,\n    width: '100%'\n  },\n  input: {\n    fontSize: 18,\n    color: \"#000\"\n  },\n  inputdimmed: {\n    fontSize: 18,\n    color: \"#737373\"\n  },\n  carphoto: {\n    height: '18px',\n    marginRight: '10px'\n  },\n  buttonStyle: {\n    margin: 0,\n    width: '100%',\n    height: '100%'\n  }\n}));\nexport default function AddBookings(props) {\n  _s();\n\n  const {\n    api\n  } = useContext(FirebaseContext);\n  const {\n    getEstimate,\n    clearEstimate,\n    addBooking,\n    clearBooking,\n    MinutesPassed,\n    GetDateString\n  } = api;\n  const dispatch = useDispatch();\n  const classes = useStyles();\n  const cartypes = useSelector(state => state.cartypes.cars);\n  const estimatedata = useSelector(state => state.estimatedata);\n  const bookingdata = useSelector(state => state.bookingdata);\n  const userdata = useSelector(state => state.usersdata);\n  const settings = useSelector(state => state.settingsdata.settings);\n  const [carType, setCarType] = useState(language.select_car);\n  const [pickupAddress, setPickupAddress] = useState(null);\n  const [dropAddress, setDropAddress] = useState(null);\n  const [estimateModalStatus, setEstimateModalStatus] = useState(false);\n  const [selectedCarDetails, setSelectedCarDetails] = useState(null);\n  const [users, setUsers] = useState(null);\n  const [commonAlert, setCommonAlert] = useState({\n    open: false,\n    msg: ''\n  });\n  const [userCombo, setUserCombo] = useState(null);\n  const [estimateRequested, setEstimateRequested] = useState(false);\n  const [bookingType, setBookingType] = useState('Book Now');\n  const [selectedDate, setSelectedDate] = useState(GetDateString());\n\n  const handleCarSelect = event => {\n    setCarType(event.target.value);\n    let carDetails = null;\n\n    for (let i = 0; i < cartypes.length; i++) {\n      if (cartypes[i].name === event.target.value) {\n        carDetails = cartypes[i];\n      }\n    }\n\n    setSelectedCarDetails(carDetails);\n  };\n\n  const handleBookTypeSelect = event => {\n    setBookingType(event.target.value);\n\n    if (bookingType === 'Book Later') {\n      setSelectedDate(GetDateString());\n    }\n  };\n\n  const onDateChange = event => {\n    setSelectedDate(event.target.value);\n  };\n\n  useEffect(() => {\n    if (estimatedata.estimate && estimateRequested) {\n      setEstimateRequested(false);\n      setEstimateModalStatus(true);\n    }\n\n    if (userdata.users) {\n      let arr = [];\n\n      for (let i = 0; i < userdata.users.length; i++) {\n        let user = userdata.users[i];\n\n        if (user.usertype === 'rider') {\n          arr.push({\n            'firstName': user.firstName,\n            'lastName': user.lastName,\n            'mobile': user.mobile,\n            'email': user.email,\n            'uid': user.id,\n            'desc': user.firstName + ' ' + user.lastName + ' (' + (features.AllowCriticalEditsAdmin ? user.mobile : \"Hidden\") + ') ' + (features.AllowCriticalEditsAdmin ? user.email : \"Hidden\"),\n            'pushToken': user.pushToken\n          });\n        }\n      }\n\n      setUsers(arr);\n    }\n  }, [estimatedata.estimate, userdata.users, estimateRequested]);\n\n  const handleGetEstimate = e => {\n    e.preventDefault();\n    setEstimateRequested(true);\n\n    if (userCombo && pickupAddress && dropAddress && selectedCarDetails) {\n      const directionService = new window.google.maps.DirectionsService();\n      directionService.route({\n        origin: new window.google.maps.LatLng(pickupAddress.coords.lat, pickupAddress.coords.lng),\n        destination: new window.google.maps.LatLng(dropAddress.coords.lat, dropAddress.coords.lng),\n        travelMode: window.google.maps.TravelMode.DRIVING\n      }, (result, status) => {\n        if (status === window.google.maps.DirectionsStatus.OK) {\n          const route = {\n            distance: result.routes[0].legs[0].distance.value / 1000,\n            duration: result.routes[0].legs[0].duration.value,\n            polylinePoints: result.routes[0].overview_polyline\n          };\n\n          if (bookingType === 'Book Now') {\n            dispatch(getEstimate({\n              pickup: pickupAddress,\n              drop: dropAddress,\n              carDetails: selectedCarDetails,\n              routeDetails: route\n            }));\n          } else {\n            if (bookingType === 'Book Later' && selectedDate) {\n              if (MinutesPassed(selectedDate) >= 15) {\n                dispatch(getEstimate({\n                  pickup: pickupAddress,\n                  drop: dropAddress,\n                  carDetails: selectedCarDetails,\n                  routeDetails: route\n                }));\n              } else {\n                setCommonAlert({\n                  open: true,\n                  msg: language.past_booking_error\n                });\n              }\n            } else {\n              setCommonAlert({\n                open: true,\n                msg: language.select_proper\n              });\n            }\n          }\n        } else {\n          setCommonAlert({\n            open: true,\n            msg: language.place_to_coords_error\n          });\n        }\n      });\n    } else {\n      setCommonAlert({\n        open: true,\n        msg: language.select_proper\n      });\n    }\n  };\n\n  const confirmBooking = e => {\n    e.preventDefault();\n    setEstimateModalStatus(false);\n    let bookingObject = {\n      pickup: pickupAddress,\n      drop: dropAddress,\n      carDetails: selectedCarDetails,\n      userDetails: {\n        uid: userCombo.uid,\n        profile: {\n          firstName: userCombo.firstName,\n          lastName: userCombo.lastName,\n          mobile: userCombo.mobile,\n          pushToken: userCombo.pushToken\n        }\n      },\n      estimate: estimatedata.estimate,\n      tripdate: new Date(selectedDate).toString(),\n      bookLater: bookingType === 'Book Later' ? true : false,\n      settings: settings,\n      booking_type_web: true\n    };\n    dispatch(addBooking(bookingObject));\n  };\n\n  const handleEstimateModalClose = e => {\n    e.preventDefault();\n    setEstimateModalStatus(false);\n    dispatch(clearEstimate());\n    setEstimateRequested(false);\n  };\n\n  const handleEstimateErrorClose = e => {\n    e.preventDefault();\n    dispatch(clearEstimate());\n    setEstimateRequested(false);\n  };\n\n  const handleBookingAlertClose = e => {\n    e.preventDefault();\n    dispatch(clearBooking());\n    dispatch(clearEstimate());\n    clearForm();\n  };\n\n  const clearForm = () => {\n    setUserCombo(null);\n    setPickupAddress(null);\n    setDropAddress(null);\n    setSelectedCarDetails(null);\n    setCarType(language.select_car);\n    setBookingType(language.book_now);\n    setEstimateRequested(false);\n  };\n\n  const handleBookingErrorClose = e => {\n    e.preventDefault();\n    dispatch(clearBooking());\n    setEstimateRequested(false);\n  };\n\n  const handleCommonAlertClose = e => {\n    e.preventDefault();\n    setCommonAlert({\n      open: false,\n      msg: ''\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 264,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    sm: 12,\n    md: 8,\n    lg: 8,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 265,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    container: true,\n    spacing: 2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 266,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 267,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Typography, {\n    component: \"h1\",\n    variant: \"h5\",\n    className: classes.title,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 268,\n      columnNumber: 13\n    }\n  }, language.addbookinglable)), /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 272,\n      columnNumber: 11\n    }\n  }, users ? /*#__PURE__*/React.createElement(UsersCombo, {\n    className: classes.items,\n    placeholder: language.select_user,\n    users: users,\n    value: userCombo,\n    onChange: (event, newValue) => {\n      setUserCombo(newValue);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 274,\n      columnNumber: 15\n    }\n  }) : null), /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 285,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(GoogleMapsAutoComplete, {\n    variant: \"outlined\",\n    placeholder: language.pickup_location,\n    value: pickupAddress,\n    className: classes.items,\n    onChange: value => {\n      setPickupAddress(value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 286,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 298,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(GoogleMapsAutoComplete, {\n    placeholder: language.drop_location,\n    variant: \"outlined\",\n    value: dropAddress,\n    className: classes.items,\n    onChange: value => {\n      setDropAddress(value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 299,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    sm: 6,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 310,\n      columnNumber: 11\n    }\n  }, cartypes ? /*#__PURE__*/React.createElement(Select, {\n    id: \"car-type-native\",\n    value: carType,\n    onChange: handleCarSelect,\n    variant: \"outlined\",\n    fullWidth: true,\n    className: carType === language.select_car ? classes.inputdimmed : classes.input,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 312,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(MenuItem, {\n    value: language.select_car,\n    key: language.select_car,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 320,\n      columnNumber: 17\n    }\n  }, language.select_car), cartypes.map(car => /*#__PURE__*/React.createElement(MenuItem, {\n    key: car.name,\n    value: car.name,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 325,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: car.image,\n    className: classes.carphoto,\n    alt: \"car types\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 326,\n      columnNumber: 23\n    }\n  }), car.name))) : null), /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    sm: 6,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 333,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Select, {\n    id: \"booking-type-native\",\n    value: bookingType,\n    onChange: handleBookTypeSelect,\n    className: classes.input,\n    variant: \"outlined\",\n    fullWidth: true,\n    inputProps: {\n      'aria-label': 'Without label'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 334,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(MenuItem, {\n    key: \"Book Now\",\n    value: \"Book Now\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 343,\n      columnNumber: 15\n    }\n  }, language.book_now), /*#__PURE__*/React.createElement(MenuItem, {\n    key: \"Book Later\",\n    value: \"Book Later\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 346,\n      columnNumber: 15\n    }\n  }, language.book_later))), bookingType === 'Book Later' ? /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    sm: 6,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 352,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(TextField, {\n    id: \"datetime-local\",\n    label: language.booking_date_time,\n    type: \"datetime-local\",\n    variant: \"outlined\",\n    fullWidth: true,\n    className: classes.commonInputStyle,\n    InputProps: {\n      className: classes.input\n    },\n    value: selectedDate,\n    onChange: onDateChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 353,\n      columnNumber: 15\n    }\n  })) : null, /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    sm: 6,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 368,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    size: \"large\",\n    onClick: handleGetEstimate,\n    variant: \"contained\",\n    color: \"primary\",\n    className: classes.buttonStyle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 369,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"fas fa-car\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 376,\n      columnNumber: 15\n    }\n  }), language.book)))), /*#__PURE__*/React.createElement(Dialog, {\n    open: estimateModalStatus,\n    onClose: handleEstimateModalClose,\n    \"aria-labelledby\": \"alert-dialog-title\",\n    \"aria-describedby\": \"alert-dialog-description\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 382,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(DialogTitle, {\n    id: \"alert-dialog-title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 388,\n      columnNumber: 9\n    }\n  }, language.estimate), /*#__PURE__*/React.createElement(DialogContent, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 389,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(DialogContentText, {\n    id: \"alert-dialog-description\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 390,\n      columnNumber: 11\n    }\n  }, settings ? settings.symbol : null, \" \", estimatedata.estimate ? estimatedata.estimate.estimateFare : null)), /*#__PURE__*/React.createElement(DialogActions, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 394,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    onClick: handleEstimateModalClose,\n    color: \"primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 395,\n      columnNumber: 11\n    }\n  }, language.cancel), /*#__PURE__*/React.createElement(Button, {\n    onClick: confirmBooking,\n    color: \"primary\",\n    autoFocus: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 398,\n      columnNumber: 11\n    }\n  }, language.book_now))), /*#__PURE__*/React.createElement(AlertDialog, {\n    open: bookingdata.booking ? true : false,\n    onClose: handleBookingAlertClose,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 403,\n      columnNumber: 7\n    }\n  }, bookingdata.booking ? language.booking_success + bookingdata.booking.booking_id : null), /*#__PURE__*/React.createElement(AlertDialog, {\n    open: bookingdata.error.flag,\n    onClose: handleBookingErrorClose,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 404,\n      columnNumber: 7\n    }\n  }, bookingdata.error.msg), /*#__PURE__*/React.createElement(AlertDialog, {\n    open: estimatedata.error.flag,\n    onClose: handleEstimateErrorClose,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 405,\n      columnNumber: 7\n    }\n  }, estimatedata.error.msg), /*#__PURE__*/React.createElement(AlertDialog, {\n    open: commonAlert.open,\n    onClose: handleCommonAlertClose,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 406,\n      columnNumber: 7\n    }\n  }, commonAlert.msg));\n}\n\n_s(AddBookings, \"6U9XSwBhSjbNjNnDIgB/NCg92PM=\", false, function () {\n  return [useDispatch, useStyles, useSelector, useSelector, useSelector, useSelector, useSelector];\n});\n\n_c = AddBookings;\n\nvar _c;\n\n$RefreshReg$(_c, \"AddBookings\");","map":{"version":3,"sources":["D:/e beta react native/eBetaDrive/web-app/src/views/AddBookings.js"],"names":["React","useState","useEffect","useContext","Select","MenuItem","Grid","Button","Dialog","DialogActions","DialogContent","DialogContentText","DialogTitle","Typography","TextField","GoogleMapsAutoComplete","useSelector","useDispatch","AlertDialog","language","makeStyles","UsersCombo","FirebaseContext","features","useStyles","theme","root","margin","spacing","body","backgroundColor","palette","common","white","container","zIndex","color","alignContent","title","gridcontainer","items","width","input","fontSize","inputdimmed","carphoto","height","marginRight","buttonStyle","AddBookings","props","api","getEstimate","clearEstimate","addBooking","clearBooking","MinutesPassed","GetDateString","dispatch","classes","cartypes","state","cars","estimatedata","bookingdata","userdata","usersdata","settings","settingsdata","carType","setCarType","select_car","pickupAddress","setPickupAddress","dropAddress","setDropAddress","estimateModalStatus","setEstimateModalStatus","selectedCarDetails","setSelectedCarDetails","users","setUsers","commonAlert","setCommonAlert","open","msg","userCombo","setUserCombo","estimateRequested","setEstimateRequested","bookingType","setBookingType","selectedDate","setSelectedDate","handleCarSelect","event","target","value","carDetails","i","length","name","handleBookTypeSelect","onDateChange","estimate","arr","user","usertype","push","firstName","lastName","mobile","email","id","AllowCriticalEditsAdmin","pushToken","handleGetEstimate","e","preventDefault","directionService","window","google","maps","DirectionsService","route","origin","LatLng","coords","lat","lng","destination","travelMode","TravelMode","DRIVING","result","status","DirectionsStatus","OK","distance","routes","legs","duration","polylinePoints","overview_polyline","pickup","drop","routeDetails","past_booking_error","select_proper","place_to_coords_error","confirmBooking","bookingObject","userDetails","uid","profile","tripdate","Date","toString","bookLater","booking_type_web","handleEstimateModalClose","handleEstimateErrorClose","handleBookingAlertClose","clearForm","book_now","handleBookingErrorClose","handleCommonAlertClose","addbookinglable","select_user","newValue","pickup_location","drop_location","map","car","image","book_later","booking_date_time","commonInputStyle","className","book","symbol","estimateFare","cancel","booking","booking_success","booking_id","error","flag"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext } from 'react';\nimport {\n  Select,\n  MenuItem,\n  Grid,\n  Button,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogContentText,\n  DialogTitle,\n  Typography,\n  TextField\n} from '@material-ui/core';\nimport GoogleMapsAutoComplete from '../components/GoogleMapsAutoComplete';\nimport { useSelector, useDispatch } from \"react-redux\";\nimport AlertDialog from '../components/AlertDialog';\nimport { language } from 'config';\nimport { makeStyles } from '@material-ui/core/styles';\nimport UsersCombo from '../components/UsersCombo';\nimport { FirebaseContext } from 'common';\nimport { features } from 'config';\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    '& > *': {\n      margin: theme.spacing(1),\n    },\n  },\n  '@global': {\n    body: {\n      backgroundColor: theme.palette.common.white,\n    },\n  },\n  container: {\n    zIndex: \"12\",\n    color: \"#FFFFFF\",\n    alignContent: 'center'\n  },\n  title: {\n    color: \"#000\",\n  },\n  gridcontainer: {\n    alignContent: 'center'\n  },\n  items: {\n    margin: 0,\n    width: '100%'\n  },\n  input: {\n    fontSize: 18,\n    color: \"#000\"\n  },\n  inputdimmed: {\n    fontSize: 18,\n    color: \"#737373\"\n  },\n  carphoto: {\n    height: '18px',\n    marginRight: '10px'\n  },\n  buttonStyle: {\n    margin: 0,\n    width: '100%',\n    height: '100%'\n  }\n}));\n\nexport default function AddBookings(props) {\n  const { api } = useContext(FirebaseContext);\n  const {\n    getEstimate, \n    clearEstimate,\n    addBooking, \n    clearBooking,\n    MinutesPassed,\n    GetDateString\n  } = api;\n  const dispatch = useDispatch();\n  const classes = useStyles();\n  const cartypes = useSelector(state => state.cartypes.cars);\n  const estimatedata = useSelector(state => state.estimatedata);\n  const bookingdata = useSelector(state => state.bookingdata);\n  const userdata = useSelector(state => state.usersdata);\n  const settings = useSelector(state => state.settingsdata.settings);\n  const [carType, setCarType] = useState(language.select_car);\n  const [pickupAddress, setPickupAddress] = useState(null);\n  const [dropAddress, setDropAddress] = useState(null);\n  const [estimateModalStatus, setEstimateModalStatus] = useState(false);\n  const [selectedCarDetails, setSelectedCarDetails] = useState(null);\n  const [users, setUsers] = useState(null);\n  const [commonAlert, setCommonAlert] = useState({ open: false, msg: '' });\n  const [userCombo, setUserCombo] = useState(null);\n  const [estimateRequested, setEstimateRequested] = useState(false);\n  const [bookingType, setBookingType] = useState('Book Now');\n  const [selectedDate, setSelectedDate] = useState(GetDateString());\n\n  const handleCarSelect = (event) => {\n    setCarType(event.target.value);\n    let carDetails = null;\n    for (let i = 0; i < cartypes.length; i++) {\n      if (cartypes[i].name === event.target.value) {\n        carDetails = cartypes[i];\n      }\n    }\n    setSelectedCarDetails(carDetails);\n  };\n\n  const handleBookTypeSelect = (event) => {\n    setBookingType(event.target.value);\n    if (bookingType === 'Book Later') {\n      setSelectedDate(GetDateString());\n    }\n  };\n\n  const onDateChange = (event) => {\n    setSelectedDate(event.target.value);\n  };\n\n  useEffect(() => {\n    if (estimatedata.estimate && estimateRequested) {\n      setEstimateRequested(false);\n      setEstimateModalStatus(true);\n    }\n    if (userdata.users) {\n      let arr = [];\n      for (let i = 0; i < userdata.users.length; i++) {\n        let user = userdata.users[i];\n        if (user.usertype === 'rider') {\n          arr.push({\n            'firstName': user.firstName,\n            'lastName': user.lastName,\n            'mobile': user.mobile,\n            'email': user.email,\n            'uid': user.id,\n            'desc': user.firstName + ' ' + user.lastName + ' (' + (features.AllowCriticalEditsAdmin? user.mobile : \"Hidden\") + ') ' + (features.AllowCriticalEditsAdmin? user.email : \"Hidden\"),\n            'pushToken': user.pushToken\n          });\n        }\n      }\n      setUsers(arr);\n    }\n  }, [estimatedata.estimate, userdata.users, estimateRequested]);\n\n\n  const handleGetEstimate = (e) => {\n    e.preventDefault();\n    setEstimateRequested(true);\n    if (userCombo && pickupAddress && dropAddress && selectedCarDetails) {\n      const directionService = new window.google.maps.DirectionsService();\n      directionService.route(\n        {\n          origin: new window.google.maps.LatLng(pickupAddress.coords.lat, pickupAddress.coords.lng),\n          destination: new window.google.maps.LatLng(dropAddress.coords.lat, dropAddress.coords.lng),\n          travelMode: window.google.maps.TravelMode.DRIVING\n        },\n        (result, status) => {\n          if (status === window.google.maps.DirectionsStatus.OK) {\n            const route = {\n              distance:(result.routes[0].legs[0].distance.value / 1000),\n              duration:result.routes[0].legs[0].duration.value,\n              polylinePoints:result.routes[0].overview_polyline\n            };\n            if (bookingType === 'Book Now') {\n              dispatch(getEstimate({\n                pickup: pickupAddress,\n                drop: dropAddress,\n                carDetails: selectedCarDetails,\n                routeDetails: route\n              }));\n            } else {\n              if (bookingType === 'Book Later' && selectedDate) {\n                if (MinutesPassed(selectedDate) >= 15) {\n                  dispatch(getEstimate({\n                    pickup: pickupAddress,\n                    drop: dropAddress,\n                    carDetails: selectedCarDetails,\n                    routeDetails: route\n                  }));\n                } else {\n                  setCommonAlert({ open: true, msg: language.past_booking_error });\n                }\n              } else {\n                setCommonAlert({ open: true, msg: language.select_proper });\n              }\n            }\n          } else{\n            setCommonAlert({ open: true, msg: language.place_to_coords_error })\n          }\n        }\n      )\n    } else {\n      setCommonAlert({ open: true, msg: language.select_proper })\n    }\n  };\n\n  const confirmBooking = (e) => {\n    e.preventDefault();\n    setEstimateModalStatus(false);\n    let bookingObject = {\n      pickup: pickupAddress,\n      drop: dropAddress,\n      carDetails: selectedCarDetails,\n      userDetails: {\n        uid:userCombo.uid,\n        profile:{\n          firstName: userCombo.firstName,\n          lastName: userCombo.lastName,\n          mobile: userCombo.mobile,\n          pushToken: userCombo.pushToken\n        }\n      },\n      estimate: estimatedata.estimate,\n      tripdate: new Date(selectedDate).toString(),\n      bookLater: bookingType === 'Book Later' ? true : false,\n      settings: settings,\n      booking_type_web: true\n    };\n    dispatch(addBooking(bookingObject));\n  };\n\n  const handleEstimateModalClose = (e) => {\n    e.preventDefault();\n    setEstimateModalStatus(false);\n    dispatch(clearEstimate());\n    setEstimateRequested(false);\n  };\n\n  const handleEstimateErrorClose = (e) => {\n    e.preventDefault();\n    dispatch(clearEstimate());\n    setEstimateRequested(false);\n  };\n\n  const handleBookingAlertClose = (e) => {\n    e.preventDefault();\n    dispatch(clearBooking());\n    dispatch(clearEstimate());\n    clearForm();\n  };\n\n  const clearForm = () => {\n    setUserCombo(null);\n    setPickupAddress(null);\n    setDropAddress(null);\n    setSelectedCarDetails(null);\n    setCarType(language.select_car);\n    setBookingType(language.book_now);\n    setEstimateRequested(false);\n  }\n\n  const handleBookingErrorClose = (e) => {\n    e.preventDefault();\n    dispatch(clearBooking());\n    setEstimateRequested(false);\n  };\n\n  const handleCommonAlertClose = (e) => {\n    e.preventDefault();\n    setCommonAlert({ open: false, msg: '' })\n  };\n\n  return (\n    <div className={classes.container}>\n      <Grid item xs={12} sm={12} md={8} lg={8}>\n        <Grid container spacing={2} >\n          <Grid item xs={12}>\n            <Typography component=\"h1\" variant=\"h5\" className={classes.title}>\n              {language.addbookinglable}\n            </Typography>\n          </Grid>\n          <Grid item xs={12}>\n            {users ?\n              <UsersCombo\n                className={classes.items}\n                placeholder={language.select_user}\n                users={users}\n                value={userCombo}\n                onChange={(event, newValue) => {\n                  setUserCombo(newValue);\n                }}\n              />\n              : null}\n          </Grid>\n          <Grid item xs={12}>\n            <GoogleMapsAutoComplete\n              variant={\"outlined\"}\n              placeholder={language.pickup_location}\n              value={pickupAddress}\n              className={classes.items}\n              onChange={\n                (value) => {\n                  setPickupAddress(value);\n                }\n              }\n            />\n          </Grid>\n          <Grid item xs={12}>\n            <GoogleMapsAutoComplete placeholder={language.drop_location}\n              variant={\"outlined\"}\n              value={dropAddress}\n              className={classes.items}\n              onChange={\n                (value) => {\n                  setDropAddress(value);\n                }\n              }\n            />\n          </Grid>\n          <Grid item xs={12} sm={6}>\n            {cartypes ?\n              <Select\n                id=\"car-type-native\"\n                value={carType}\n                onChange={handleCarSelect}\n                variant=\"outlined\"\n                fullWidth\n                className={carType === language.select_car ? classes.inputdimmed : classes.input}\n              >\n                <MenuItem value={language.select_car} key={language.select_car}>\n                  {language.select_car}\n                </MenuItem>\n                {\n                  cartypes.map((car) =>\n                    <MenuItem key={car.name} value={car.name}>\n                      <img src={car.image} className={classes.carphoto} alt=\"car types\" />{car.name}\n                    </MenuItem>\n                  )\n                }\n              </Select>\n              : null}\n          </Grid>\n          <Grid item xs={12} sm={6}>\n            <Select\n              id=\"booking-type-native\"\n              value={bookingType}\n              onChange={handleBookTypeSelect}\n              className={classes.input}\n              variant=\"outlined\"\n              fullWidth\n              inputProps={{ 'aria-label': 'Without label' }}\n            >\n              <MenuItem key={\"Book Now\"} value={\"Book Now\"}>\n                {language.book_now}\n              </MenuItem>\n              <MenuItem key={\"Book Later\"} value={\"Book Later\"}>\n                {language.book_later}\n              </MenuItem>\n            </Select>\n          </Grid>\n          {bookingType === 'Book Later' ?\n            <Grid item xs={12} sm={6} >\n              <TextField\n                id=\"datetime-local\"\n                label={language.booking_date_time}\n                type=\"datetime-local\"\n                variant=\"outlined\"\n                fullWidth\n                className={classes.commonInputStyle}\n                InputProps={{\n                  className: classes.input\n                }}\n                value={selectedDate}\n                onChange={onDateChange}\n              />\n            </Grid>\n            : null}\n          <Grid item xs={12} sm={6} >\n            <Button\n              size=\"large\"\n              onClick={handleGetEstimate}\n              variant=\"contained\" \n              color=\"primary\"\n              className={classes.buttonStyle}\n            >\n              <i className=\"fas fa-car\" />\n              {language.book}\n            </Button>\n          </Grid>\n        </Grid>\n      </Grid>\n      <Dialog\n        open={estimateModalStatus}\n        onClose={handleEstimateModalClose}\n        aria-labelledby=\"alert-dialog-title\"\n        aria-describedby=\"alert-dialog-description\"\n      >\n        <DialogTitle id=\"alert-dialog-title\">{language.estimate}</DialogTitle>\n        <DialogContent>\n          <DialogContentText id=\"alert-dialog-description\">\n            {settings?settings.symbol:null} {estimatedata.estimate ? estimatedata.estimate.estimateFare : null}\n          </DialogContentText>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={handleEstimateModalClose} color=\"primary\">\n            {language.cancel}\n          </Button>\n          <Button onClick={confirmBooking} color=\"primary\" autoFocus>\n            {language.book_now}\n          </Button>\n        </DialogActions>\n      </Dialog>\n      <AlertDialog open={bookingdata.booking ? true : false} onClose={handleBookingAlertClose}>{bookingdata.booking ? language.booking_success + bookingdata.booking.booking_id : null}</AlertDialog>\n      <AlertDialog open={bookingdata.error.flag} onClose={handleBookingErrorClose}>{bookingdata.error.msg}</AlertDialog>\n      <AlertDialog open={estimatedata.error.flag} onClose={handleEstimateErrorClose}>{estimatedata.error.msg}</AlertDialog>\n      <AlertDialog open={commonAlert.open} onClose={handleCommonAlertClose}>{commonAlert.msg}</AlertDialog>\n    </div>\n  );\n}"]},"metadata":{},"sourceType":"module"}